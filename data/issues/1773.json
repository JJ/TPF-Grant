{
  "body": "Ref: https://docs.perl6.org/language/nativecall#Notes_on_Memory_management\r\n\r\nThe example under \"Notes on Memory management\" has some problems:\r\n\r\n1.  A Perl6 runtime error occurs because the init() method is declared with only named args but called with positionals.\r\n\r\n2.  The code (with above problem fixed) segfaults or corrupts memory because of a buffer-overflow: No storage is allocated in the $!a_string member which C code writes into.\r\n\r\nThe C code does `strcpy(target->a_string, str);` where `target->a_string` is a (char *) pointer in the `$.a_string` field/attribute of the CStruct in Perl6 code.\r\n\r\nHowever this attribute is only ever bound with \r\n  ` $!a_string := Str.new;`\r\nbut no space is allocated for a non-zero-length string.\r\n\r\nI'll try to attach a shell script which demos the problem.\r\n[demo.sh.txt](https://github.com/perl6/doc/files/1718082/demo.sh.txt)\r\n\r\n",
  "author_association": "NONE",
  "assignees": [
    
  ],
  "assignee": null,
  "node_id": "MDU6SXNzdWUyOTY1NjU3NzY=",
  "closed_by": {
    "following_url": "https://api.github.com/users/CurtTilmes/following{/other_user}",
    "node_id": "MDQ6VXNlcjc0NjkyMjk=",
    "gists_url": "https://api.github.com/users/CurtTilmes/gists{/gist_id}",
    "received_events_url": "https://api.github.com/users/CurtTilmes/received_events",
    "organizations_url": "https://api.github.com/users/CurtTilmes/orgs",
    "subscriptions_url": "https://api.github.com/users/CurtTilmes/subscriptions",
    "html_url": "https://github.com/CurtTilmes",
    "id": 7469229,
    "login": "CurtTilmes",
    "type": "User",
    "repos_url": "https://api.github.com/users/CurtTilmes/repos",
    "site_admin": false,
    "events_url": "https://api.github.com/users/CurtTilmes/events{/privacy}",
    "gravatar_id": "",
    "avatar_url": "https://avatars0.githubusercontent.com/u/7469229?v=4",
    "starred_url": "https://api.github.com/users/CurtTilmes/starred{/owner}{/repo}",
    "followers_url": "https://api.github.com/users/CurtTilmes/followers",
    "url": "https://api.github.com/users/CurtTilmes"
  },
  "updated_at": "2018-02-13T19:03:38Z",
  "created_at": "2018-02-12T23:48:44Z",
  "comments_url": "https://api.github.com/repos/perl6/doc/issues/1773/comments",
  "locked": false,
  "title": "Broken example (segfaults) of NativeCall memory management",
  "id": 296565776,
  "html_url": "https://github.com/perl6/doc/issues/1773",
  "closed_at": "2018-02-13T14:21:22Z",
  "milestone": null,
  "state": "closed",
  "labels_url": "https://api.github.com/repos/perl6/doc/issues/1773/labels{/name}",
  "number": 1773,
  "comments": 3,
  "labels": [
    
  ],
  "events_url": "https://api.github.com/repos/perl6/doc/issues/1773/events",
  "user": {
    "following_url": "https://api.github.com/users/jimav/following{/other_user}",
    "node_id": "MDQ6VXNlcjEyNjIyNzI=",
    "gists_url": "https://api.github.com/users/jimav/gists{/gist_id}",
    "received_events_url": "https://api.github.com/users/jimav/received_events",
    "organizations_url": "https://api.github.com/users/jimav/orgs",
    "subscriptions_url": "https://api.github.com/users/jimav/subscriptions",
    "html_url": "https://github.com/jimav",
    "id": 1262272,
    "login": "jimav",
    "type": "User",
    "repos_url": "https://api.github.com/users/jimav/repos",
    "site_admin": false,
    "events_url": "https://api.github.com/users/jimav/events{/privacy}",
    "gravatar_id": "",
    "avatar_url": "https://avatars0.githubusercontent.com/u/1262272?v=4",
    "starred_url": "https://api.github.com/users/jimav/starred{/owner}{/repo}",
    "followers_url": "https://api.github.com/users/jimav/followers",
    "url": "https://api.github.com/users/jimav"
  },
  "repository_url": "https://api.github.com/repos/perl6/doc",
  "url": "https://api.github.com/repos/perl6/doc/issues/1773"
}